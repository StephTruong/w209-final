
<!DOCTYPE html>

<style>
.container_chart1 {
  position: absolute;
  left: 0px;
  width: 350px;
}
.container_chart2{
  position: absolute;
  left: 350px;
  width: 350px;
}
</style>

<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Physicians' Pharma Relationships</title>
        <script type="text/javascript" src="../d3.js"></script>
    </head>
    <h2> Physicians' Pharma Relationships</h2>
    <body>    
    <div class="container_chart1" id="chart1">
    	<p align="center">Medicare Prescriptions Written - 2013</p>
	</div>
	<div class="container_chart2" id="chart2">
		<p align="center">Money Received from Pharmacuetical Companies</p>
	</div>    
        <script type="text/javascript">	
        	//Width and height
			var w = 300;
			var h = 500;
			var barPadding = 1;
			var barHeight = 20
			var padding = 40;
			var barColor = "#62b5d1"
			var svg_chart1 = d3.select("#chart1")
			.append("svg")
			.attr("width",w)
			.attr("height",h);

			var svg_chart2 = d3.select("#chart2")
			.append("svg")
			.attr("width",w)
			.attr("height",h);

	        d3.json("Main_Table_Lens_Data.json", function(data) {
				jsn_Main_Table_Lens_Data = data
				dataset = jsn_Main_Table_Lens_Data.map(function(a) {return [a.Prescriptions_Written,a.Amt_Payments_Received,a.Drug];});


				var xScale = d3.scale.linear()
					.domain([0,d3.max(dataset,function(d){return d[0];})])
					.range([padding ,w-padding*2 ]);

				var yScale = d3.scale.linear()
					.domain([0,15])
					.range([padding ,h-padding ]); //reverse to y scale goes from bottom to top

				//Create chart 1
				svg_chart1.selectAll("rect")
				   .data(dataset.sort(function(a, b){return b[0] - a[0];}))
				   .enter()
				   .append("rect")
				   .attr("y", function(d, i) {
				   		return yScale(i);
				   })
				   .attr("x", xScale(padding))
				   .attr("height", barHeight)
				   .attr("width", function(d) {
				   		return xScale(d[0]);
				   })
				   .attr("fill", d3.rgb(barColor));
				
				var xScale = d3.scale.linear()
					.domain([0,d3.max(dataset,function(d){return d[1];})])
					.range([padding ,w-padding*2 ]);


				//Create chart 2
				svg_chart2.selectAll("rect")
				   .data(dataset.sort(function(a, b){return b[0] - a[0];}))
				   .enter()
				   .append("rect")
				   .attr("y", function(d, i) {
				   		return yScale(i);
				   })
				   .attr("x", xScale(padding))
				   .attr("height", barHeight)
				   .attr("width", function(d) {
				   		return xScale(d[1]);
				   })
				   .attr("fill", d3.rgb(barColor));


				//Add Labels chart 1
				svg_chart1.selectAll("text")
					.data(dataset.sort(function(a, b){return b[0] - a[0];}))
					.enter()
					.append("text")
					.text(function(d) {return d[2]})
					.attr("x", xScale(padding)+5)
					.attr("y", function(d, i) {
				   		return yScale(i)+barHeight/2;
				   	})
					.attr("font-family","sans-serif")
					.attr("font-size", "12px")
					.attr("fill","black")
					.attr("text-anchor","end");

				//Add Labels chart 2
				svg_chart2.selectAll("text")
					.data(dataset.sort(function(a, b){return b[0] - a[0];}))
					.enter()
					.append("text")
					.text(function(d) {return d[2]})
					.attr("x", xScale(padding))
					.attr("y", function(d, i) {
				   		return yScale(i)+barHeight/2;
				   	})
					.attr("font-family","sans-serif")
					.attr("font-size", "12px")
					.attr("fill","black")
					.attr("text-anchor","end");

			});
	

	




		</script>


    </body>

</html>